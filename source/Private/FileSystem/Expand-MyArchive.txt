function Expand-MyArchive {
    <#
    .SYNOPSIS
        Expands the specified archive file to the given destination path.

    .DESCRIPTION
        Extracts an archive file (e.g., zip) to the specified destination. Ensures paths are fully qualified and creates the destination directory if it does not exist. Logs all actions.

    .PARAMETER ArchivePath
        The path to the archive file to expand.

    .PARAMETER DestinationPath
        The path to the directory where the contents will be extracted.

    .PARAMETER Indent
        Indentation level for output messages. Default is 0.

    .PARAMETER Overwrite
        If specified, overwrites existing files in the destination directory.

    .PARAMETER LogFile
        The path where the log file will be saved.

    .EXAMPLE
        Expand-MyArchive -ArchivePath "C:\Data\Archive.zip" -DestinationPath "C:\Data\ExtractedFiles" -Overwrite
    #>

    [CmdletBinding(SupportsShouldProcess = $true)]
    param (
        [Parameter(Mandatory = $true)]
        [string]$ArchivePath,

        [Parameter(Mandatory = $true)]
        [string]$DestinationPath,

        [Parameter(Mandatory = $false)]
        [int]$Indent = 0,

        [Parameter(Mandatory = $false)]
        [switch]$Overwrite,

        [Parameter(Mandatory = $false)]
        [string]$LogFile = $PSLA.Settings.LogFilePath
    )

    $ArchivePathFull = $ArchivePath
    $DestinationPathFull = $DestinationPath

    if (-not (Test-Path -Path $ArchivePathFull -PathType Leaf)) {
        Write-LogInfo -Message "Archive file not found: $ArchivePath" -Indent $Indent -MessageType Error -LogFile $LogFile
        throw "Archive file not found: $ArchivePath"
    }

    if ($Overwrite -and (Test-Path -Path $DestinationPathFull -PathType Container) -and ($PSLA.Debug.SkipArchiveExtraction -ne $true)) {
        if ($PSCmdlet.ShouldProcess($DestinationPathFull, 'Remove destination directory for overwrite')) {
            Remove-Item -Path $DestinationPathFull -Recurse -Force | Out-Null
            Write-LogInfo -Message "Destination directory removed: $DestinationPath" -Indent $Indent -MessageType Verbose -LogFile $LogFile
        }
    }

    if ($PSCmdlet.ShouldProcess($DestinationPathFull, 'Create destination directory')) {
        New-Folder $DestinationPathFull -Indent $Indent -LogFile $LogFile
    }

    Write-LogInfo -Message "Destination directory: $DestinationPath" -Indent $Indent -MessageType Verbose -LogFile $LogFile

    if (!$PSLA.Debug.SkipArchiveExtraction) {
        try {
            Add-Type -AssemblyName System.IO.Compression.FileSystem
            if ($PSCmdlet.ShouldProcess($ArchivePathFull, "Extract archive to $DestinationPathFull")) {
                Expand-Archive -Path $ArchivePathFull -DestinationPath $DestinationPathFull
                Write-LogInfo -Message "Archive extracted successfully to: $DestinationPath" -Indent $Indent -MessageType Success -LogFile $LogFile
            }
        } catch {
            Write-LogInfo -Message "Error extracting archive: $ArchivePath to $DestinationPath. Error: $_" -Indent $Indent -MessageType Error -LogFile $LogFile
            throw
        }
    } else {
        Write-LogInfo -Message "[Simulated] Archive extracted successfully to: $DestinationPath" -Indent $Indent -MessageType Success -LogFile $LogFile
    }
}
